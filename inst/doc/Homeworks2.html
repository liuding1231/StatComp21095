<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Liu Dingding" />


<title>Homeworks2</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homeworks2</h1>
<h4 class="author">Liu Dingding</h4>
<h4 class="date">2021/12/16</h4>



<div id="question-8.2" class="section level2">
<h2>Question 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for independence as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="anwser" class="section level2">
<h2>Anwser</h2>
<p>This example tests whether the distributions of petal length and sepal length of iris setosa are independent. To implement a permutation test, write a function to compute the replicates of the test statistic that takes as its first argument the data matrix and as its second argument the permutation vector. The permutation test procedure for independence permutes the row indices of one of the samples.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cor.sprman<span class="ot">&lt;-</span><span class="cf">function</span>(z,ix){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute the Spearman rank correlation test statistic</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#z:two samples x and y</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ix:a permutation of row indices of y</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>z[,<span class="dv">1</span>]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>z[ix,<span class="dv">2</span>]<span class="co">#permutate rows of y</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Large absolute values of cor.sprman support the alternative hypothesis that the two samples is not irrelevant.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])<span class="co">#Sepal.length and Petal.length</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>asl<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>asl<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">4</span>,<span class="at">expr=</span>{<span class="co">#compute achieved significance level of the permutation test</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>cor.sprman,<span class="at">R=</span><span class="dv">999</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  tb<span class="ot">&lt;-</span><span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(tb,<span class="at">nclass=</span><span class="st">&quot;scott&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;cor_spearman&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">freq=</span><span class="cn">FALSE</span>,)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(boot.obj<span class="sc">$</span>t0,<span class="dv">0</span>,<span class="at">cex=</span><span class="dv">1</span>,<span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">abs</span>(tb)<span class="sc">&gt;=</span>boot.obj<span class="sc">$</span>t0)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We implement permutation tests four times.The four histograms of replicates of the Spearman rank correlation test statistic are shown in above Figure with points of the observation for the statistic($t0).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(asl)</span></code></pre></div>
<pre><code>## [1] 0.057 0.059 0.046 0.051</code></pre>
<p>The achieved significance levels of the permutation test are <span class="math inline">\(0.057,0.059,0.046, 0.051\)</span>,so the null hypothesis of independence is rejected at <span class="math inline">\(\alpha = 0.10\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>z[,<span class="dv">1</span>]<span class="co">#Sepal.length</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>z[,<span class="dv">2</span>]<span class="co">#Petal.length</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>c<span class="ot">&lt;-</span><span class="fu">cor.test</span>(x,y,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>,<span class="at">exact =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(c<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## [1] 0.04985095</code></pre>
<p>The p-value reported by cor.test on the same samples Sepal.length and Petal.length is <span class="math inline">\(0.04985095\)</span>.</p>
<p>Compared with the p-value by cor.test,the four achieved significance levels we get(0.057,0.059,0.046, 0.051) is varying.</p>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>(1)Unequal variances and equal expectations</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
</ol>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="anwser-1" class="section level2">
<h2>Anwser</h2>
<p>The approximate permutation energy test is implemented in eqdist.etest in the energy package.And R package “Ball” gives Ball statistic. So firstly we write a function to compute Nearest neighbor statistic:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)<span class="co">#for nn2 function </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)<span class="co">#for eqdist.etest()</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>knn<span class="ot">&lt;-</span><span class="cf">function</span>(z,ix,sizes,k){</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute k-Nearest neighbor statistic</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">&lt;-</span>sizes[<span class="dv">1</span>]</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">&lt;-</span>sizes[<span class="dv">2</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z))z<span class="ot">&lt;-</span><span class="fu">data.frame</span>(z)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span>z[ix,]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  NN<span class="ot">&lt;-</span><span class="fu">nn2</span>(z,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  block1<span class="ot">&lt;-</span>NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  block2<span class="ot">&lt;-</span>NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  i1<span class="ot">&lt;-</span><span class="fu">sum</span>(block1<span class="sc">&lt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  i2<span class="ot">&lt;-</span><span class="fu">sum</span>(block2<span class="sc">&gt;</span>n1<span class="fl">+.5</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">*</span>n))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>knn.test<span class="ot">&lt;-</span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>knn,<span class="at">R=</span><span class="dv">999</span>, <span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  tb<span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(tb<span class="sc">&gt;=</span>boot.obj<span class="sc">$</span>t0)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>boot.obj<span class="sc">$</span>t0,<span class="at">p.value=</span>p.value)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Unequal variances and equal expectations</li>
</ol>
<p>we produce random variables from the below two multi-normal distributions: <span class="math inline">\(N(\mu_1,\Sigma_1)\)</span>and<span class="math inline">\(N(\mu_2,\Sigma_2)\)</span> where<span class="math display">\[\mu_1=\mu_2=(0,0,0)\]</span> <span class="math display">\[\Sigma_1=\begin{pmatrix}
1&amp;0&amp;0\\
0&amp;1&amp;0\\
0&amp;0&amp;1\\
\end{pmatrix}
\Sigma_2=\begin{pmatrix}
3&amp;0&amp;0\\
0&amp;2&amp;0\\
0&amp;0&amp;3\\
\end{pmatrix}\]</span></p>
<p>Then we implement three permutation tests:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mu2<span class="ot">&lt;-</span>mu1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span>n2<span class="ot">=</span><span class="dv">15</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>powr<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)<span class="co">#store power for three kinds tests</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">##compute p-values for nn,energy,ball methods</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n1,mu1,s1)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n2,mu2,s2)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">knn.test</span>(z,<span class="at">sizes=</span>N,k)<span class="sc">$</span>p.value<span class="co">#NN method</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  p2<span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#energy method</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(x,y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#ball method</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1,p2,p3)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  powr[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">as.numeric</span>(p.values[i,])<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="do">##set alpha as 0.05</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="at">power_nn=</span>powr[<span class="dv">1</span>],<span class="at">power_energy=</span>powr[<span class="dv">2</span>],<span class="at">power_ball=</span>powr[<span class="dv">3</span>]))</span></code></pre></div>
<pre><code>##     power_nn power_energy   power_ball 
##         0.18         0.16         0.63</code></pre>
<p>From the result we can see that the power of Ball method is obviously higher than the other two methods.And NN method performs better than energy method.</p>
<ol start="2" style="list-style-type: decimal">
<li>Unequal variances and unequal expectations</li>
</ol>
<p>We produce random variables from the below two multi-normal distributions: <span class="math inline">\(N(\mu_1,\Sigma_1)\)</span>and<span class="math inline">\(N(\mu_2,\Sigma_2)\)</span> where<span class="math display">\[\mu_1=(0,0,0),\mu_2=(1,1,1)\]</span> <span class="math display">\[\Sigma_1=\begin{pmatrix}
1&amp;0&amp;0\\
0&amp;1&amp;0\\
0&amp;0&amp;1\\
\end{pmatrix}
\Sigma_2=\begin{pmatrix}
2&amp;0&amp;0\\
0&amp;2&amp;0\\
0&amp;0&amp;3\\
\end{pmatrix}\]</span></p>
<p>Then we implement three permutation tests:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mu1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>);mu2<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span>n2<span class="ot">=</span><span class="dv">15</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>powr<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)<span class="co">#store power for three kinds tests</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">##compute p-values for nn,energy,ball methods</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n1,mu1,s1)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n2,mu2,s2)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">knn.test</span>(z,<span class="at">sizes=</span>N,k)<span class="sc">$</span>p.value<span class="co">#NN method</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  p2<span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#energy method</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(x,y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#ball method</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1,p2,p3)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  powr[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">as.numeric</span>(p.values[i,])<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="do">##set alpha as 0.05</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="at">power_nn=</span>powr[<span class="dv">1</span>],<span class="at">power_energy=</span>powr[<span class="dv">2</span>],<span class="at">power_ball=</span>powr[<span class="dv">3</span>]))</span></code></pre></div>
<pre><code>##     power_nn power_energy   power_ball 
##         0.74         0.91         0.93</code></pre>
<p>From the result we can see that Ball method performs best .And NN method performs worse than energy method.</p>
<ol start="3" style="list-style-type: decimal">
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
</ol>
<p>We produce random variables from the below two non-normal distributions:t distribution</p>
<p>Then we implement three permutation tests:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span>n2<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>powr<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)<span class="co">#store power for three kinds tests</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">##compute p-values for nn,energy,ball methods</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">rt</span>(n1,<span class="dv">1</span>,<span class="dv">2</span>));y<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">rt</span>(n2,<span class="dv">2</span>,<span class="dv">5</span>))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">knn.test</span>(z,<span class="at">sizes=</span>N,k)<span class="sc">$</span>p.value<span class="co">#NN method</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  p2<span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#energy method</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(x,y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#ball method</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1,p2,p3)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  powr[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">as.numeric</span>(p.values[i,])<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="do">##set alpha as 0.05</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="at">power_nn=</span>powr[<span class="dv">1</span>],<span class="at">power_energy=</span>powr[<span class="dv">2</span>],<span class="at">power_ball=</span>powr[<span class="dv">3</span>]))</span></code></pre></div>
<pre><code>##     power_nn power_energy   power_ball 
##         0.65         0.52         0.81</code></pre>
<p>From the result,the Ball method is also of best performance and energy method performs worst.</p>
<p>Next,We produce random variables from the below two non-normal distributions:bimodel distribution <span class="math display">\[0.3N(0,1)+0.7N(1,4),0.5N(0,4)+0.5N(1,1),\]</span></p>
<p>Then we implement three permutation tests:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span>n2<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>powr<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)<span class="co">#store power for three kinds tests</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">##compute p-values for nn,energy,ball methods</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  e1<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">0.3</span>))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>e1<span class="sc">*</span><span class="fu">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>e1)<span class="sc">*</span><span class="fu">rnorm</span>(n1,<span class="dv">1</span>,<span class="dv">2</span>)<span class="co">#x is data from bimodel distribution</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(x)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  e2<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>e2<span class="sc">*</span><span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">2</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>e2)<span class="sc">*</span><span class="fu">rnorm</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>)<span class="co">#y is data from bimodel distribution</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(y)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">knn.test</span>(z,<span class="at">sizes=</span>N,k)<span class="sc">$</span>p.value<span class="co">#NN method</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  p2<span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#energy method</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(x,y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#ball method</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1,p2,p3)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  powr[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">as.numeric</span>(p.values[i,])<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="do">##set alpha as 0.05</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="at">power_nn=</span>powr[<span class="dv">1</span>],<span class="at">power_energy=</span>powr[<span class="dv">2</span>],<span class="at">power_ball=</span>powr[<span class="dv">3</span>]))</span></code></pre></div>
<pre><code>##     power_nn power_energy   power_ball 
##         0.07         0.07         0.07</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Unbalanced samples:</li>
</ol>
<p>We produce two samples from the below two multi-normal distributions: <span class="math inline">\(N(\mu_1,\Sigma_1)\)</span>and<span class="math inline">\(N(\mu_2,\Sigma_2)\)</span> where<span class="math display">\[\mu_1=\mu_2=(0,0,0)\]</span> <span class="math display">\[\Sigma_1=\begin{pmatrix}
1&amp;0&amp;0\\
0&amp;1&amp;0\\
0&amp;0&amp;1\\
\end{pmatrix}
\Sigma_2=\begin{pmatrix}
3&amp;0&amp;0\\
0&amp;2&amp;0\\
0&amp;0&amp;3\\
\end{pmatrix}\]</span></p>
<p>Then we implement three permutation tests,but the two sample sizes is 10 vs 100:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mu2<span class="ot">&lt;-</span>mu1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="dv">10</span>;n2<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2 </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>powr<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)<span class="co">#store power for three kinds tests</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>p.values<span class="ot">&lt;-</span><span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="do">##compute p-values for nn,energy,ball methods</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n1,mu1,s1)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n2,mu2,s2)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">knn.test</span>(z,<span class="at">sizes=</span>N,k)<span class="sc">$</span>p.value<span class="co">#NN method</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  p2<span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#energy method</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(x,y,<span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value<span class="co">#ball method</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1,p2,p3)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  powr[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">as.numeric</span>(p.values[i,])<span class="sc">&lt;</span><span class="fl">0.05</span>)<span class="do">##set alpha as 0.05</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="at">power_nn=</span>powr[<span class="dv">1</span>],<span class="at">power_energy=</span>powr[<span class="dv">2</span>],<span class="at">power_ball=</span>powr[<span class="dv">3</span>]))</span></code></pre></div>
<pre><code>##     power_nn power_energy   power_ball 
##         0.07         0.02         0.79</code></pre>
<p>From the result,we can see that Ball method is still of best performance;it’s power is much higher than the other methods.NN method is slightly better than energy.</p>
</div>
<div id="question-9.3" class="section level2">
<h2>Question 9.3</h2>
<ol style="list-style-type: decimal">
<li><p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a <span class="math inline">\(Cauchy(\theta, \eta)\)</span> distribution has density function <span class="math display">\[f(x) =\frac{1} {\theta\pi(1 + [(x − \eta)/\theta]2)}, −\infty&lt;x&lt; \infty, \theta&gt; 0.\]</span> The standard Cauchy has the <span class="math inline">\(Cauchy(\theta = 1, \eta= 0)\)</span> density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p></li>
<li><p>Use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p></li>
</ol>
</div>
<div id="anwser-2" class="section level2">
<h2>Anwser</h2>
<p>A standard Cauchy distribution has density function <span class="math inline">\(f(x) =\frac{1} {\pi(1 + x^2)}, −\infty&lt;x&lt; \infty.\)</span> i.e. <span class="math inline">\(\theta=1,\eta=0\)</span></p>
<p>For the proposal distribution, try the normal distribution <span class="math inline">\(N(X_t,\sigma^2)\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)<span class="co">#初始化随机向量</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#建议分布选择方差为1的正态分布,从标准正态分布中生成X0并储存在x[1]中</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>        xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>xt,<span class="at">sd=</span><span class="dv">1</span>)<span class="co">#从N(Xt,1)=N(x[i-1],1)中生成y</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        num <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="at">mean=</span>y,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        den <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, <span class="at">mean=</span>xt,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den){</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>          x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>          x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>          k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span>     <span class="co">#y is rejected</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    index<span class="ot">&lt;-</span><span class="dv">5000</span><span class="sc">:</span><span class="dv">5500</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> x[index]</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(index, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The above figure present Part of a chain generated by a Metropolis-Hastings sampler of a standard Cauchy distribution</p>
<p>Standard Cauchy distribution has cdf:<span class="math inline">\(F(x)=\frac{arctan x}{\pi}+\frac{1}{2},−\infty&lt;x&lt; \infty.\)</span></p>
<p>So we can conduct an explicit formula for the quantiles of the Standard Cauchy distribution as:<span class="math display">\[x_q=F^{-1}(q)=tan(\pi(q-0.5))\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1001</span>      <span class="co">#discard the burn-in sample</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    QC<span class="ot">&lt;-</span> <span class="fu">tan</span>(pi<span class="sc">*</span>(a<span class="fl">-0.5</span>)) <span class="co">#quantiles of Cauchy</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, a) <span class="co">#the deciles of the generated chain</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(y, <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">main=</span><span class="st">&quot;Standard Cauchy&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(QC, <span class="fu">dcauchy</span>(QC),<span class="at">col=</span><span class="st">&#39;blue&#39;</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">qqplot</span>(QC, Q, <span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Cauchy deciles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample deciles&quot;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> The histogram of the generated sample with the Standard Cauchy density superimposed is shown in left figure and the QQ plot is shown in the right Figure. From the plot, it appears that the sample Deciles are in approximate agreement with the theoretical Deciles.</p>
<p>Next we ues the Gelman-Rubin method to monitor the convergence of the above chain.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>    Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    cauchy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>( sigma,N, X1) {</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">#generates a Metropolis chain for stantard cauchy distribution</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">#with Normal(X[t], 1) proposal distribution</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#and starting value X1</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>            xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean=</span>xt, <span class="at">sd=</span>sigma)     <span class="co">#candidate point</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>            r1 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, <span class="at">sd=</span>sigma)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>            r2 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, <span class="at">sd=</span>sigma)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>            r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>                 x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(x)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate the chains</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    sigma<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">0.1</span>)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>    GR<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(sigma))</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma)){</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>        X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauchy.chain</span>(sigma[j],n, x0[i])</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>      <span class="co">#compute diagnostic statistics</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>      psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>      GR[j]<span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(GR)</span></code></pre></div>
<pre><code>##  [1] 1.330653 3.374922 2.664715 2.111193 1.099508 1.177350 1.418482 2.475350
##  [9] 1.669565 1.936160 1.832877</code></pre>
<p>According <span class="math inline">\(\hat{R}&lt;1.2\)</span>,so we choose sigma=1.9.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    sigma<span class="ot">=</span><span class="fl">1.9</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauchy.chain</span>(sigma,n, x0[i])</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="co">#compute diagnostic statistics</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>      psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n],<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">col=</span>i)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>      }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.148132</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> The plot of <span class="math inline">\(\hat{R}\)</span> is shown in Figure for time 1001 to 15000. The value of <span class="math inline">\(\hat{R}\)</span> is below 1.2 within 12000 iterations.</p>
</div>
<div id="question-9.8" class="section level2">
<h2>Question 9.8</h2>
<ol style="list-style-type: decimal">
<li>Consider the bivariate density <span class="math display">\[f(x, y) \varpropto {n\choose x}y^{x+a−1}(1 − y)^
{n−x+b−1}, x = 0, 1, . . . , n, 0 ≤ y ≤ 1.\]</span> It can be shown that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).</li>
</ol>
<p>2.use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
</div>
<div id="anwser-3" class="section level2">
<h2>Anwser</h2>
<p>The conditional densities of the given distribution is:<span class="math inline">\(f(x|y)\)</span> is the density of Binomial(n, y),<span class="math inline">\(f(y|x)\)</span> is the density of Beta(x + a, n − x + b).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">2</span>;b<span class="ot">=</span><span class="dv">3</span>;n<span class="ot">=</span><span class="dv">10</span><span class="co">#初始化参数</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span><span class="dv">5</span>;x2<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x1, x2) <span class="co">#initialize</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size=</span>n, <span class="at">prob=</span>x2)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>bu <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[bu<span class="sc">:</span>N, ]</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Means: &#39;</span>,<span class="fu">round</span>(<span class="fu">colMeans</span>(x),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Means:  4.06 0.41</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Standard errors: &#39;</span>,<span class="fu">round</span>(<span class="fu">apply</span>(x,<span class="dv">2</span>,sd),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Standard errors:  2.45 0.2</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Correlation coefficients: &#39;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>]),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Correlation coefficients:  0.81</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(X[<span class="dv">1</span>]),<span class="fu">expression</span>(X[<span class="dv">2</span>])),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmZmZmkJBmtrZmtv+QOgCQOmaQkGaQ2/+2ZgC2/7a2///bkDrbkJDb/7bb/9vb///fU2v/tmb/25D//7b//9v////76DGoAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIcUlEQVR4nO2dDXurJhiG6Vmabcm+mq2eua01if//P04UjV/4gLxJkD731dNjE4pwVwHxlaiSLKKeXYDYoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOAm6HI8lLlSu48nliZCboKy3cd5/1pmr08sTYR0gi7Ht7JQ1b9vfz+zPNExEJRVcnIKGtA7xV4vx93H5chTbEC/kVYv79cT/QwR7ubVZvAWdD0dJAQJ5PEQ/AXpRvqB+302/oJk+vdnCfLe75ojyJycazzNn9rtz+bV3k+3lHqj+erSmYRNun6qdhfq9pZJOWpS2mS9PMtxEuequSZckZ2oIEVB0QuqTrLdRxbWl6UsqHh5z/VIOshQwoL0OKgSFHgtlrAgPQ7SgsJ6+4QFtUdQFjRjlrAg0wblKmhAnbKgZqj48u76myi79ARJQEFO2d0qYr63NSxLyxttRbtf7zK55dcXpCYZmYTD5KVSM38Ir3qPT7HAmxpA0LRe0oJUeTdBRd0852GNUMKC2gkziW4+SUHthJnEQDFJQe10fc4jaF5Q1Qbpc6xgGzRXo246US3PKGZKvV5PVSLbcDtVQY7U12rqtQl0oKAJdUfXnIO2liplQe1pZj/F6o6u6eVGfV2vSOMKDWs3sjJ6d/qz/cXVrBV0PcHuy/MImqvdhgW53Djs2iDrbdiEBTndevbqxeZqt2FB5fnHsKmg9AXtmwzELjXmardhQTKRQQkLkozusNduw4Ik44PstduwIDbSQFBQ+IuzoPvW3Ym1gmSgoK8riKcYEGQIjFRMX1DgwyxfQJDcXQ0XBRsUJBFA5a5ge4ICH2ZJWFDbi4XdnE9YkAwUZMllsPvHV9qH1YLqqVQlPlCMjtWCMrmHWZ7tYJG1ggIjyL+CoPvMKEbHWkH3mpOOjrWCTAgeBdkE3Wu6IzrWCpJhA4IMiQmSLWWZ3hEkW8qSghwLKpnQJzsKAtmlKQiH4Dlnl6QghxA85+ySFBT3tZhA0eYK6pPQI7rjvLe6TFiQQ3SHQzx+0oJwCF7zOMcXPYKcpjv0KmdzgkY1SVKQYyOdvbxv6gg675vOefy4+/0a6VwdtiTINAvn/ah2d2mkTbr9D1sSVN+MmLYf95wwu57sc48RCtI306cBB7wWu3He/z495BMX5CczV9PmdY2geiAksnbHvQX5pK2bhGmzsequhvYssvrLvQX5ke3+NTE9l187Ueu7ebnHwiMRVK8BXf/xL8dvAYLkFxaIQ5BeRLwZ317//M4jaML1VP/Bm2ukoFMszTaoG7MV9dPsQYI21IutJVCQBBTklF16glzX7nDMLlZBk4J6JRRf/SUxQfLrByUmKNWB4mJBfRLKr2EWhSC5KdegVfBGNYlIkOCUq/g6inEIEptylSFCQZxyRUhNuUb9rMZoN59LTAolNOUa9bMaw70s+pkIEppyjftZjZAy3aZcJwV1rlGZcHxQN+Wq25BO1J2CFxyzi0nQbco1f60q2R4FqweKgUQnaDDlWrXXbTtyz1vPODuvun/eU9BwyrU3IRTHOKjqUgYqPtvvn907eqP5at/v/X71Stk4lCnd5ZfuOuq5gpruVvW+G1o15o1O0OdNUOVk0GcLCurHr6wQJBgnPXCyPGgZpbCkFhF0/qlXszUDxd1H1c4vBEe5Zwed+CIiKNN//pBG+lAW+sOPBOaD4hQ0U1CfhHqgqA/CwYG4cr9JCtIzirqVXxQEL2gTFlTPmWSHxVOsuywuZq6Pe9mlKUivPVX1ZAudWC8Qdnk96UAd09+PQxCkdz0LViTvVa333dr9q9v/ehx0S6dUhIL+sR5CzkeQOBEIyk3Lay7u5ununYA2SJznC9J3nPUdsULZql4Dl6lKVVA9GVQ1MbnoJ9TJ8XRB9Xzr9fSzCp00c5m6iANfQbpxyRZPLx9NsumekmyY3AiSeKzXpwybEyQxK+1TBgqSSUdBMSYbJheLUfQrw3YECUNBQplSkEy69ASlBAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgLICyqWHr43wTVdmumGO7k9kxW52RAXpO/RWp8MNsuLdGmmG+7ocB1LJitysyItqAlwsMxuF82EbpdmuuGOudc5l8mK3OxIC2qCQOc/pKxQhzpspksz3fDcmxYkl9ss4oLqWGTro9ONoDbNdMNzb/oJW7ncZpEW1Jz61gagLnWXZrrht686FEUqNwtbFtQsgr0xQY89xbSFjZ1ioIEUbqR1VhtrpEEXW4h1842FKr+NdfNgkFbIDRR1sE6tYlsDxd4VwBymYejSTDfc0Q+nvInlZoMXqwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQID5Bk6gDqTCEdVAQgIIAUQq6HP84NqEtOo7lLy2o2tARmzpsTGb1fVciFaRXWNfLquloemV+0B8/oyOmwlab9SVSQYde+GFmXqijr4pv33956BkXqaC3esmeLmCvaYZqX1nwOmt+RC0o7wSZpXvehD6bwIOoBY2OIM319JtMeK8rUQsyAc/mhZp899/pkZ1Y3ILqzqvrxZrW+k0qhN6RuAUNx0F6wes6OPqRzXR8giKDggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A9UJux8w99JTQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Next we ues the Gelman-Rubin method to monitor the convergence of the above chain.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>    Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        x.chain <span class="ot">&lt;-</span> <span class="cf">function</span>( N, X1,yvalue) {</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">#generates a Metropolis chain for Binormial distribution</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">#with poisson(Xt) proposal distribution</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">#and starting value X1</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>            xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,<span class="at">lambda=</span>xt)     <span class="co">#candidate point</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>            r1 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span>yvalue) <span class="sc">*</span> <span class="fu">dpois</span>(xt, y)<span class="co">#n=10</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>            r2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(xt,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span>yvalue) <span class="sc">*</span> <span class="fu">dpois</span>(y, xt)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>            r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>                 x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(x)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>        y.chain <span class="ot">&lt;-</span> <span class="cf">function</span>( N, X1,xvalue) {</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">#generates a Metropolis chain for stantard cauchy distribution</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">#with chisq(X[t], 1) proposal distribution</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">#and starting value X1</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>        u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>            xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span>xt)     <span class="co">#candidate point</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>            r1 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(y,xvalue<span class="sc">+</span><span class="dv">2</span>,<span class="dv">13</span><span class="sc">-</span>xvalue) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, y)<span class="co">#a=2,b=3</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>            r2 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(xt,xvalue<span class="sc">+</span><span class="dv">2</span>,<span class="dv">13</span><span class="sc">-</span>xvalue) <span class="sc">*</span> <span class="fu">dchisq</span>(y, xt)<span class="co">#a=2,b=3</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>            r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>                 x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(x)</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>    <span class="co">#choose overdispersed initial values</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>    y0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate the chains</span></span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">16</span>)</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span>Y<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>        X[i, ] <span class="ot">&lt;-</span> <span class="fu">x.chain</span>(n, x0[i],<span class="at">yvalue=</span><span class="fl">0.8</span>)</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>        Y[i, ] <span class="ot">&lt;-</span> <span class="fu">y.chain</span>(n, y0[i],<span class="at">xvalue=</span><span class="dv">3</span>)}</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>      <span class="co">#compute diagnostic statistics</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>      psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>      psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi1)){</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>        psi1[i,] <span class="ot">&lt;-</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>        psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))}</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi1),<span class="fu">Gelman.Rubin</span>(psi2)))</span></code></pre></div>
<pre><code>## [1] 1.070058 1.098311</code></pre>
<p>Two Marginal distributions (we choose x=3;y=0.8) satisfy that <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    rhat1<span class="ot">&lt;-</span> rhat2<span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        rhat1[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        rhat2[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat1[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.3</span>))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>we choose x=3 to monitor the convergence of distribution f(x,3) and y=0.8 to monitor the convergence of distribution f(0.8,y).The two figures tell us the chains are converging fast.The two values of <span class="math inline">\(\hat{R}\)</span> are both below 1.2 within 2000 iterations.</p>
</div>
<div id="question-11.3" class="section level2">
<h2>Question 11.3</h2>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the kth term in<span class="math display">\[\sum_{k=0}^{\infty}\frac{(-1)^k}{k!2^k}\frac{\parallel a\parallel^{2k+2}}{(2k + 1)(2k + 2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)},\]</span> where <span class="math inline">\(d\ge1\)</span> is an integer, a is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(\parallel ·\parallel\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large k and d. (This sum converges for all <span class="math inline">\(a \in R^d\)</span>).</li>
<li>Modify the function so that it computes and returns the sum.</li>
<li>Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span> .</li>
</ol>
</div>
<div id="anwser-4" class="section level2">
<h2>Anwser</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="do">##compute terms</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>fa<span class="ot">&lt;-</span><span class="cf">function</span>(k,a){</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">##compute kth term for the series</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="at">length=</span>k)<span class="co">#1 or -1 for k</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  ik<span class="ot">&lt;-</span>i[k]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>k<span class="dv">-1</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  c1<span class="ot">=</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  c2<span class="ot">&lt;-</span><span class="fu">factorial</span>(k)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span>ik<span class="sc">*</span>c1<span class="sc">*</span><span class="fu">norm</span>(a)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>c2</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="do">##compute sum</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>fb<span class="ot">&lt;-</span><span class="cf">function</span>(k,a){</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">##return sum for k terms</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="at">length=</span>k)<span class="co">#1 or -1 for k</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  K<span class="ot">&lt;-</span><span class="dv">0</span><span class="sc">:</span>(k<span class="dv">-1</span>)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  c1<span class="ot">=</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(K<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(K<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  c2<span class="ot">&lt;-</span><span class="fu">factorial</span>(K)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>K<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>K<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>K<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span>i<span class="sc">*</span>c1<span class="sc">*</span><span class="fu">norm</span>(a)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>K<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>c2</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(c))</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">fa</span>(<span class="dv">1</span>,a),<span class="fu">fa</span>(<span class="dv">2</span>,a),<span class="fu">fa</span>(<span class="dv">3</span>,a)))<span class="co">#terms for k=0,1,2</span></span></code></pre></div>
<pre><code>## [1]  3.534292 -1.988039  1.491029</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  f[i]<span class="ot">&lt;-</span><span class="fu">fb</span>(k[i],a)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(f[<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>)])<span class="co">#sums until k=4,9,14,19,24</span></span></code></pre></div>
<pre><code>## [1] 1.988902 2.415488 2.405410 2.405440 2.405440</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(k[<span class="dv">15</span><span class="sc">:</span><span class="dv">25</span>],f[<span class="dv">15</span><span class="sc">:</span><span class="dv">25</span>]))</span></code></pre></div>
<table>
<colgroup>
<col width="8%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">14.00000</td>
<td align="right">15.000000</td>
<td align="right">16.000000</td>
<td align="right">17.00000</td>
<td align="right">18.000000</td>
<td align="right">19.00000</td>
<td align="right">20.00000</td>
<td align="right">21.00000</td>
<td align="right">22.00000</td>
<td align="right">23.00000</td>
<td align="right">24.00000</td>
</tr>
<tr class="even">
<td align="right">2.40541</td>
<td align="right">2.405447</td>
<td align="right">2.405438</td>
<td align="right">2.40544</td>
<td align="right">2.405439</td>
<td align="right">2.40544</td>
<td align="right">2.40544</td>
<td align="right">2.40544</td>
<td align="right">2.40544</td>
<td align="right">2.40544</td>
<td align="right">2.40544</td>
</tr>
</tbody>
</table>
<p>From the result,we can see that the sum is <span class="math inline">\(2.405440\)</span> retaining 6 decimals when <span class="math inline">\(k\ge6\)</span>.</p>
</div>
<div id="question-11.4" class="section level2">
<h2>Question 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt k)\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\Bigg(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\Bigg)\]</span> and<span class="math display">\[S_{k}(a)=P\Bigg(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}\Bigg)\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with <span class="math inline">\(k\)</span> degrees of freedom.</p>
</div>
<div id="anwser-5" class="section level2">
<h2>Anwser</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">##function for S_k(a)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pt</span>(x,<span class="at">df=</span>k,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(a,k) <span class="fu">sk</span>(a,k)<span class="sc">-</span><span class="fu">sk</span>(a,k<span class="dv">-1</span>)<span class="co">#xlim is (0,sqrt(k))</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span> <span class="sc">:</span> <span class="dv">25</span>,<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>root1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(K))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="do">##first to find the approximation of the root for f</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,<span class="fu">f</span>(a,<span class="dv">100</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a,<span class="fu">f</span>(a,<span class="dv">500</span>),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a,<span class="fu">f</span>(a,<span class="dv">1000</span>),<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;k=100&quot;</span>, <span class="st">&quot;k=500&quot;</span>, <span class="st">&quot;k=1000&quot;</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAAP8AOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmtv+QOgCQZgCQtpCQ2/+2ZgC225C2///bkDrb////AAD/tmb/25D//7b//9v///+QRqbNAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHtklEQVR4nO2di3ajNhRFNck8OnGbtHGHDnH8/79ZSTYYA7pHEgIu+Oy1Mn6Akdijx5UsgzkTEbN2BrRDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAhQWZzbCWoEU+UgAKKpUqBZXacbbDUdCyOSidKgWV2nG2w1HQsjkonSoFldpxtsNR0LI5KJ0qBZXacbbDUdCyOSid6pYFnQ4vwzc//vjlHmpjvrzfPclMdW+CTocnJ6i2Utzf7UluqjsTZMuLE/T55rYcv92eZKe6eUGV6ViqzUvtBH18f7Wvqqdf7ZPsVNUJSpgodYIq82p1+G3XNscL+vF+edo+yc6oOkEJWEG1ee296WVcWh37b/skO9VtC/pphq0QBbWcDl/++dE/dVaxG64NOn79b6wN2nEjnYATdDHQoWY33+K7+WOvdNQMFFu8oNPhvnhc25uqqXKViqHGIl8CFyVDUH3Nbz+wyEjXnJ+f7cPv3zF/2xB0OphrSf18M8M2PzVd//DsCO963fq8CUGnv7pO7l/lpNtNvvE0eEzNalFWbqRTjkpBy+agdKrNjrbp8UxofzqH25+gdlalHg7/ctJNOOuSE2a2r7G47qbwlOslIvdUdnCTz8qCPpqxa+lI+nRoo5+RkW8CKwtqMl98LLbhEnQ35VpdTZQfzVdNAL21Nuh+yvX40z6+zDIfdGnejJlUfjrpxp/22Jy08NhhMOV6OrjsH1+2MKOYLSiB0SlXX14oyDM65eoboBmqWNlAcSlBI1OuvgGao5EuGyguJuhuyvXywpYX/d38IpV8OOXqTdhGWn+guJyg+ynXYzPjV3jKdZslaAprB4q7E1Q8UNydoPLpxh55V4JgtPTggnC09NiCIvq6vQpqmmh5sBERLS0qKG2V6/3ca2oJ+nyLiA+1laCkVa69kDpjsDocrwzA0dLagoKrXPuDsvQ2aLjabzRL49HS6EqEyDyUnHINr3LtD+sVxEHLCIpd5dqfGNquIFcIpb8OKatc+1OL2xE0YX1QyirXBxUUv8p1kSoWES2Z4ItgBgpPua7aSONoKVmQKTnl6giscp3ezUcBo6XFBUWvcp0aKLYEpiib5EG0tLyg6FWu1aShRimM8Cqw/yYGqzOlS0HgcPsS1HTiUkeVMqMYlYstCbIRRfVt2G12SZpRjMmFidlpFtIFuS6htlGX8L1Y2nxQTDa2JejVz8ZdZ+TGSJtRjMnGlgS54nH6810S9NglyI9Tji/iV89JM4oR2TAR+8xETjdvByq2JxNHW/D71366cj42JmiOdCkIHE48vJkjB5EkCor9OVRioBgnaB2wmrsziPtBXWqgGCVoHTKqGP5JZno3L2ZkTT9zTbmmBoq7EWRP3QWJgAcuQXYgFiEoPVCUMrKqn+QqVt2adylSTA4UhZxsS9D5HFOCctLdjaBpyYXDi1AC6/qZ72sfUA0fXFB6oBhOYY+Ccrr5hxKUEyiGUljZj6YSNJ7ELgXlBIqhJPYpKCdQTJC2JFomzEJvUpD85up+FAWKo2/uVVBWoDg2xN+poMxuPvW7jkVQFCiOvLtXQdklqPe2Aj+qAsXB2/sVlBconnutsoImWlkc1Htfgx91gjobVPiZXdDI9VTkw7X1SkUFU1iCmi1K/CgUdNmkxY9KQUmLKuZG1WBVI6oGqxpRNtTQh67BqkJWK0GbYQ5B0depQgcF26dtnvrxSbtHXqfqcQUVOujOBXWaosyDUtC07RREQdO2U9DOBU0/6MML2hMUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIUF5Q4K6LHYQr8Fy+3BamU+SrGHqO4a8UbjeJjKa4oNDNdG5cLxo+yueb/WgVPgW3Lkk+uv0PCgv6GLnbFqC0oODtmFpq6YfVwdtdXfCXlpQvB2oLSVhQxo2LSgsCZ3i7aLiEXEZkQdXXv8OCqqTa5SkuKHRLuA5QUP/6rPdUkj6bvtAGNTeJTKC0oOBNBbv7AEHiF9u1eIauhocFtTeJTEChoBp0M59vQh2ym4QSFJN8D31VDN/AK6zfp44EidfSHLB4I30GgircRoTPsLkEiWggra9fvpuXBVXiybV3eZQOHy5BUR/vsUKgKOXw47tcftzJoy8upV6suUlkPOWHGngwIAi61pHwAY6oAsltUMTHe3CwCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAqgXlL5gpSzaBbklT+K637lRLsjf1Ctt1WVhlAty1KvWMe2CKmOe/mUJCuJrF6tYGL/es2YVC+IKz+mQ+PuToigXdFlUfFyxn9cuaHUoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA/2Fpw5+mvsPyAAAAAElFTkSuQmCC" /><!-- --></p>
<p>We can get a appropriate interval <span class="math inline">\((1,2)\)</span> contained root value.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(K)){</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>K[i]</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">&lt;-</span><span class="fu">uniroot</span>(<span class="cf">function</span>(a){</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sk</span>(a,K[i])<span class="sc">-</span><span class="fu">sk</span>(a,K[i]<span class="sc">-</span><span class="dv">1</span>)},</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  root1[i]<span class="ot">&lt;-</span>out<span class="sc">$</span>root</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(K[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],root1[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]))</span></code></pre></div>
<table>
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">4.000000</td>
<td align="right">5.000000</td>
<td align="right">6.000000</td>
<td align="right">7.00000</td>
<td align="right">8.000000</td>
<td align="right">9.000000</td>
<td align="right">10.00000</td>
<td align="right">11.000000</td>
<td align="right">12.000000</td>
<td align="right">13.000000</td>
<td align="right">14.00000</td>
<td align="right">15.000000</td>
</tr>
<tr class="even">
<td align="right">1.492103</td>
<td align="right">1.533556</td>
<td align="right">1.562744</td>
<td align="right">1.58443</td>
<td align="right">1.601185</td>
<td align="right">1.614521</td>
<td align="right">1.62539</td>
<td align="right">1.634419</td>
<td align="right">1.642038</td>
<td align="right">1.648554</td>
<td align="right">1.65419</td>
<td align="right">1.659114</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(K[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)],root1[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)]))</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">16.000000</td>
<td align="right">17.000000</td>
<td align="right">18.000000</td>
<td align="right">19.00000</td>
<td align="right">20.000000</td>
<td align="right">21.000000</td>
<td align="right">22.000000</td>
<td align="right">23.00000</td>
<td align="right">24.000000</td>
<td align="right">25.000000</td>
<td align="right">100.000000</td>
<td align="right">500.000000</td>
<td align="right">1000.000000</td>
</tr>
<tr class="even">
<td align="right">1.663452</td>
<td align="right">1.667304</td>
<td align="right">1.670745</td>
<td align="right">1.67384</td>
<td align="right">1.676637</td>
<td align="right">1.679178</td>
<td align="right">1.681496</td>
<td align="right">1.68362</td>
<td align="right">1.685572</td>
<td align="right">1.687373</td>
<td align="right">1.720608</td>
<td align="right">1.729756</td>
<td align="right">1.730908</td>
</tr>
</tbody>
</table>
</div>
<div id="question-11.5" class="section level2">
<h2>Question 11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}\Bigg(1+\frac{u^2}{k-1}\Bigg)^{-\frac{k}{2}}du\\
=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi k}\Gamma(\frac{k}{2})}\int_0^{c_{k}}\Bigg(1+\frac{u^2}{k}\Bigg)^{-\frac{k+1}{2}}du\]</span><br />
for a,where<span class="math display">\[c_k=\sqrt{\frac{a^2k}{k+1-a^2}}.\]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="anwser-6" class="section level2">
<h2>Anwser</h2>
<p>Reduce <span class="math inline">\(\frac{2}{\sqrt\pi}\)</span> to get the follwing equation: <span class="math display">\[\frac{\Gamma(\frac{k}{2})}{\sqrt{(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}\Bigg(1+\frac{u^2}{k-1}\Bigg)^{-\frac{k}{2}}du\\
=\frac{\Gamma(\frac{k+1}{2})}{\sqrt{ k}\Gamma(\frac{k}{2})}\int_0^{c_{k}}\Bigg(1+\frac{u^2}{k}\Bigg)^{-\frac{k+1}{2}}du\]</span></p>
<p>First we write a function to compute the integration in the equation</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fck<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">##compute integration</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  ck<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  v<span class="ot">&lt;-</span><span class="fu">integrate</span>(<span class="cf">function</span>(u){</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)},</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> ck,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rel.tol =</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span>)<span class="sc">$</span>value</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(k)<span class="sc">*</span>v)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="do">##write function to compute the right minus the left</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>fun<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">##a is a numeric vector</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span>m</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    x[i]<span class="ot">&lt;-</span><span class="fu">fck</span>(a[i],k)<span class="sc">-</span><span class="fu">fck</span>(a[i],k<span class="dv">-1</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>K<span class="ot">&lt;-</span>s.root<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span> <span class="sc">:</span> <span class="dv">25</span>,<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a,<span class="fu">fun</span>(a,<span class="dv">100</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a,<span class="fu">fun</span>(a,<span class="dv">500</span>),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a,<span class="fu">fun</span>(a,<span class="dv">1000</span>),<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;k=100&quot;</span>, <span class="st">&quot;k=500&quot;</span>, <span class="st">&quot;k=1000&quot;</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAAP8AOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmtv+QOgCQZgCQtpCQ2/+2ZgC225C2///bkDrb////AAD/tmb/25D//7b//9v///+QRqbNAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJTklEQVR4nO2dDZvaKBRGaafTbp3d7W7dpnWs//9vbkiMxgR4L3DBfLzneaajNSKeIXAhEMyFBDHPzsDSoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCADGCzm+H9t+TMebjj1L5WRzRgppPP+2jv4vlaGHECrqq6TTtglhB7587QafdnGQsQYA4QW39bF4vQ3W9CyKb+dbRh+9tQ7YbP4yDEBQEiBPUtHVQX0mzFXPRtPXP+c3W0hTk4ve3Q/dv28RTkIuhg3H89JOCXPQlqOX4SkFOBi1tNERBTpq+DWvLEgWRHgoCxAn6/c107OYEi62kh07qjnqrSc08x4PcjEaiOaLogiUIMYRBrIN89IOuxuym/DAOglAQgIEigIEiQLmZN6uhhCBBoJhQpT2nFiwiSFKCIpJLf4sCRQT5A8X4kpuYAzXKCMKBYjA5t79NCcpJzupxGaKgh5fmB2xKEAwU/ckZ3xFbEoQDRW9ytxdmZ9mGBGU08yMtU0MbEpQRKBr/MRsSlF6CHkrNpAhtSJBgRNEnSPysFssKFINlZlOCEpMLNlwUVEyQczLy+x9d83Eydjru+EE4S15qBIrh6FlX0Pmty9vJTla2Ym4PJBl1USNQrCjo1P/x+vb2+Hp/IMqoixrNvEOQCb0qpV99NP5btX+4LkLrV5Q0H3/cHogy6uJ+4Ok6ouNf6OQPFMPjQeEu/DRulA+UWkE28nj/3L12rXM6QV++9w9vDwR5cmOGzzLXYthWM74aJrEEgf/LKkGn2d+zk9HXOu2/tweSTDnpDzz/NXby+GxEWqAISlWOoK/zfJQRJM9SQqBYUNCHf79Mv3qhU0wL8YihjqCDnbPtqoP0K2mla6byIVUDXhcwWgF551SmmY+9ZuqbSF5d0OU4ycmpSKCoNjVKPuSsJahfXHPnWt80wynXqHQ11CbXRQjyDlJXYfklyD+KX4X4Okg0uS6hs7oRQbLJdQmd1UBGDDyiIIvprO5KUMpVjc0IkgSKCSUolI9VCZIFivGd1WA+DD4kyHzA7H5vCOUhV2kz76vKveNBlQW9D31X7Ui6WKBYWdCQefW+WLFAMZwPgw8JMR9yba4m9HvzWqswqgt6HHI9fm1/H4qMBymtwpgOMAuOdo1JB36PmA25nt9s9o+H540oxiaHUjdZOXAOuXblhYI6nEOuXQW0miHX0oIcQ65dBVTkupgKJvDMc7jikGv/pC0v6s38UEVnj0pHCrJHaA65dibaSlr/2rzWvSbqC3occj0Ol4aVh1ytoXkxTKCqoBzi66D5Rdzsz5VkwqxGUIHPpSCQHAWB5CgIJCdKO2WJmQKVBTkHzGRJ70OQM7niguJmuT6Ova5HkOqIYmCW6ySkThfkiTwTknuGIO8s12mnbD8lSDjLddqtX4AgacqaQ64X7xS86cDQegXZSjv0MyJmlut0aDFB0DDkoTXcUaMEyWe5Kgiyt7B9nc/5i6OyIPks1/xTzJ7QJ3sjZK3rYnXqIOks1/xK2l5ctUHWNdBKpLog6SzX/GbepnD+87uaoArNRNQs1/xA0Ra/40HtFKslSDzLtcnuarTlL/tG0VUF5VAke4LtsygIbJ+1VUGy5VD+zY/m40Hyr70KQbIFdYLtszYr6CJbkgm3z9qyIIxg+6x9C7rg7bO2LEhlSZ2Z/I7KQU1SevMa0xc2LEi0K594tc8mBeGBIPlqnw0KEsx/iVirESPoOYizd3uE579ErPaJLxaVC1LKKWZQKyYvQQnfdvGCJIhX+6R827qGCgWK0ltTOFJ9sdjfOjnJpcgpJk9u/PGDmdHz6/96clKF5BKUuSfNWNDUzIyJqKqG0k8xx6TrO8JA0by8/Pp1uQh/XvqfsExt0gWFipA3UKwdxCiQLCiw/2WZe9orvfkS98WTBU2vojy+VmJXBIU3RxWJyM+atWKBy2KlS1Dau+PlRH1UmUAxkYQOSuoUx9irGm9/28vOkLxdEYSZiTg+fQZotKCDSJDe5yq8PUNP/CnW3Ns/5RsslXp7lp6kSlpSgjJ2RYjMDjoud/55qUo6eVcE3ezkT88vIqh4My9MQGP1QqELh2UDxS4BmEL22dWnon7gpU4JgikoLX5ZZ6AoSEJrcdCTRxRzCCWht3aqkKAqyfnTUFxbVllQ/DBLMDHfCwqJR6cV96HFA8U+EWcquksT1xooXlOZJ6NTOEfpqR94qdTM98lM01Ff2braQHFIxzw+U7/isfIS9OCkgJ5VB4q3pBQbRkfq6gd21AgU67DmQLEKFARYdaBYg6cFiquhhCDxHV/hmE7Jl3PfnnG4+J7BexXEEoSQ3jN4t4Kk9wzeryClRCko7/UtCArMQxMkugNBeYnuXtCWoCCAcmd1eyh3VrdHka7GlijSWd0SLEGAIp3VLVGks7olGAcBEgSNqqIdQEEACgLoC/LsujgidKvGrjMT3IcS3u766G9C7ndAEqMuyLeZzp3rTcM9abdvbfxfwY5DhVNv/0B+Qe+O3bYA2q2YdzumG6dQX9e73VVPd4ua8F1G2kLiF5TQAdAWBL7h/abhIcJlJCyo+fSPX1ATv4GRuiDflnAjoKDwvZ6akL728wN10LBJZATagrybCo6PAYKCHZlT8BvaM9wv6LZJZAQLFHQCzczvb4FzqH0pUIIkHz9heacY7gj79XefjgTF3XS9eiV9AYIaXEf4v+GwsjRoIK6tr9/Mo7tfhL7cbZfHUPL+EiR6+wT13jwOFEM5fP8cLj/2y6OuTqgVGzaJlKM/3IE7AwFB13PEn8ARnUDhOkjw9gkcDwJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEWLyh+woouSxdkpzwF5/2WZuGCur0a4mZdKrNwQZbTU8+xpQtqjPn4H0uQl+7s4inmp5vvibfILcjCBdnCc3575iL0hQvqJxUfn9jOL13Q06EgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggD/A1UghbgrWCFXAAAAAElFTkSuQmCC" /><!-- --></p>
<p>We can get a appropriate interval <span class="math inline">\((1,2)\)</span> contained root value.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>root2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(K))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(K)){</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>K[i]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">&lt;-</span><span class="fu">uniroot</span>(<span class="cf">function</span>(a){</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fck</span>(a,k)<span class="sc">-</span><span class="fu">fck</span>(a,k<span class="dv">-1</span>)},</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  root2[i]<span class="ot">&lt;-</span>out<span class="sc">$</span>root</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(K[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],root2[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>],root1[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]))</span></code></pre></div>
<table>
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">4.000000</td>
<td align="right">5.000000</td>
<td align="right">6.000000</td>
<td align="right">7.00000</td>
<td align="right">8.000000</td>
<td align="right">9.000000</td>
<td align="right">10.00000</td>
<td align="right">11.000000</td>
<td align="right">12.000000</td>
<td align="right">13.000000</td>
<td align="right">14.00000</td>
<td align="right">15.000000</td>
</tr>
<tr class="even">
<td align="right">1.492103</td>
<td align="right">1.533556</td>
<td align="right">1.562744</td>
<td align="right">1.58443</td>
<td align="right">1.601185</td>
<td align="right">1.614521</td>
<td align="right">1.62539</td>
<td align="right">1.634419</td>
<td align="right">1.642038</td>
<td align="right">1.648554</td>
<td align="right">1.65419</td>
<td align="right">1.659114</td>
</tr>
<tr class="odd">
<td align="right">1.492103</td>
<td align="right">1.533556</td>
<td align="right">1.562744</td>
<td align="right">1.58443</td>
<td align="right">1.601185</td>
<td align="right">1.614521</td>
<td align="right">1.62539</td>
<td align="right">1.634419</td>
<td align="right">1.642038</td>
<td align="right">1.648554</td>
<td align="right">1.65419</td>
<td align="right">1.659114</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(K[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)],root2[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)],root1[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)]))</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="right">16.000000</td>
<td align="right">17.000000</td>
<td align="right">18.000000</td>
<td align="right">19.00000</td>
<td align="right">20.000000</td>
<td align="right">21.000000</td>
<td align="right">22.000000</td>
<td align="right">23.00000</td>
<td align="right">24.000000</td>
<td align="right">25.000000</td>
<td align="right">100.000000</td>
<td align="right">500.000000</td>
<td align="right">1000.000000</td>
</tr>
<tr class="even">
<td align="right">1.663452</td>
<td align="right">1.667304</td>
<td align="right">1.670745</td>
<td align="right">1.67384</td>
<td align="right">1.676637</td>
<td align="right">1.679178</td>
<td align="right">1.681496</td>
<td align="right">1.68362</td>
<td align="right">1.685572</td>
<td align="right">1.687373</td>
<td align="right">1.720608</td>
<td align="right">1.729756</td>
<td align="right">1.730907</td>
</tr>
<tr class="odd">
<td align="right">1.663452</td>
<td align="right">1.667304</td>
<td align="right">1.670745</td>
<td align="right">1.67384</td>
<td align="right">1.676637</td>
<td align="right">1.679178</td>
<td align="right">1.681496</td>
<td align="right">1.68362</td>
<td align="right">1.685572</td>
<td align="right">1.687373</td>
<td align="right">1.720608</td>
<td align="right">1.729756</td>
<td align="right">1.730908</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#root1 are the roots of ex 11.4;root2 are the roots of ex 11.5</span></span></code></pre></div>
<p>The solutions of this question are the same as the points A(k) in Exercise 11.4</p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Suppose <span class="math inline">\(T_1, . . . , T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than τ are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i \le \tau ) + \tau I(Ti &gt; \tau ),i = 1, . . . , n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution)</p>
</div>
<div id="anwser-7" class="section level2">
<h2>Anwser</h2>
<p>Rearrange the sample <span class="math inline">\(Y_i\)</span> putting 1 at the end as follows : <span class="math display">\[0.54, 0.48, 0.33, 0.43, 0.91, 0.21, 0.85,1.00, 1.00,1.00\]</span> We can conduct that <span class="math inline">\(T_i=Y_i,i=1,...,7;Y_j=1.00,j=8,9,10\)</span></p>
<p>The density is <span class="math display">\[f(x)=\lambda e^{-\lambda x},x&gt;0.\]</span> <span class="math display">\[P(T&gt;1)= e^{-\lambda }.\]</span> Suppose <span class="math inline">\(y_i,i=1,...,10\)</span> are observed values.</p>
<p><strong>Observed data likelihood:</strong> <span class="math display">\[L(\lambda|y_1,...,y_{10})=\prod_{i=1}^{7}f(y_i)\cdot\prod_{j=8}^{10}P(T_j&gt;1)\\=\lambda^{-7}\cdot exp\{-\lambda^{-1}\cdot(\sum_{i=1}^{7}y_i+3)\}\]</span> <span class="math display">\[l(\lambda|y_1,...,y_{10})=-7log\lambda-\lambda^{-1}\cdot(\sum_{i=1}^{7}y_i+3)\]</span></p>
<p>From <span class="math inline">\(\frac{\partial l}{\partial \lambda}=0\)</span>,we can get <strong>the observed data MLE</strong> : <span class="math display">\[\lambda_0=\frac{\sum_{i=1}^{7}y_i+3}{7}\]</span></p>
<p><strong>Complete data likelihood:</strong> <span class="math display">\[l(\lambda;y_1,...,y_{7},T_8,T_9,T_{10})=-10log\lambda-\lambda^{-1}\cdot(\sum_{i=1}^{7}y_i+\sum_{j=8}^{10}T_j)\]</span> <strong>Kth E-step:</strong> Initiate <span class="math inline">\(\lambda\)</span> with <span class="math inline">\(\lambda_k\)</span>,then caculate</p>
<p><span class="math display">\[l_k(\lambda;y_1,...,y_{10})=E_{\lambda_k}[l(\lambda;y_1,...,y_{7},T_8,T_9,T_{10}|y_1,...,y_{7},T_j\ge1,j=8,9,10)]
\\=-10log\lambda-\lambda^{-1}\cdot(\sum_{i=1}^{7}y_i+\sum_{j=8}^{10}E_{\lambda_k}[T_j|T_j\ge1])
\\=-10log\lambda-\lambda^{-1}\cdot(\sum_{i=1}^{7}y_i+3(\lambda_k+1))
\]</span></p>
<p>where<span class="math display">\[E_{\lambda}[T_j|T_j\ge1]=\frac{\int_1^\infty \lambda xe^{-\lambda x}dx}{P(T&gt;1)}
\\=\frac{\int_1^\infty \lambda xe^{-\lambda x}dx}{e^{-\lambda}}
\\=\frac{(\lambda+1)e^{-\lambda}}{e^{-\lambda}}
\\=\lambda+1\]</span> <strong>Kth M-step:</strong>maximize <span class="math inline">\(l_k(\lambda;y_1,...,y_{10})\)</span>,from <span class="math inline">\(\frac{\partial l_k}{\partial \lambda}=0\)</span>,we can get : <span class="math display">\[\lambda_{k+1}=\frac{\sum_{i=1}^{7}y_i+3(\lambda_k+1)}{10}\]</span></p>
<p>The sequence <span class="math inline">\(\{\lambda_k\}\)</span> has convergence.</p>
<p><span class="math display">\[\lambda=\frac{\sum_{i=1}^{7}y_i+3(\lambda+1)}{10}\Rightarrow\lambda
=\frac{\sum_{i=1}^{7}y_i+3}{7}\]</span></p>
<p>The convergence of <span class="math inline">\(\{\lambda_k\}\)</span> is <span class="math inline">\(\frac{\sum_{i=1}^{7}y_i+3}{7}\)</span>.</p>
<p><strong>The EM estimator is exactly the observed data MLE!</strong></p>
<p>Then implement EM algorithm</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nloptr)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">0.91</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>,<span class="fl">1.00</span>, <span class="fl">1.00</span>,<span class="fl">1.00</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>eval.lam<span class="ot">&lt;-</span><span class="cf">function</span>(lam,lam0,<span class="at">data=</span>y){</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">*</span><span class="fu">log</span>(lam)<span class="sc">+</span>(<span class="fu">sum</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>lam0<span class="sc">+</span><span class="dv">3</span>)<span class="sc">/</span>lam</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>l0<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fl">0.8</span>)<span class="do">##initial est. for lambdas</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>tol<span class="ot">&lt;-</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>opts <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;algorithm&quot;</span><span class="ot">=</span><span class="st">&quot;NLOPT_LN_COBYLA&quot;</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;xtol_rel&quot;</span><span class="ot">=</span>tol)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>j<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">abs</span>(d)<span class="sc">&gt;</span>tol){</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">&lt;-</span><span class="fu">nloptr</span>(<span class="at">x0=</span><span class="fl">0.8</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">eval_f=</span>eval.lam,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">lb=</span><span class="dv">0</span>,<span class="at">ub=</span><span class="dv">10</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">opts =</span> opts,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">lam0=</span>l0[j],<span class="at">data=</span>y)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span>l0[j]<span class="sc">-</span>out<span class="sc">$</span>solution</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  l0<span class="ot">&lt;-</span><span class="fu">c</span>(l0,out<span class="sc">$</span>solution)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l0)<span class="co">#lambdas</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">length</span>(l0)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>lam.EM<span class="ot">&lt;-</span>(<span class="fu">sum</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])<span class="sc">+</span><span class="dv">3</span>)<span class="sc">/</span><span class="dv">7</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(k,l0[k],lam.EM),<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;iteration times&quot;</span>,<span class="st">&quot;test result&quot;</span>,<span class="st">&quot;theoretical values&quot;</span>))</span></code></pre></div>
<p>From the chart,the iteration times is 15;and the test result of lambda is <span class="math inline">\(0.9642857\)</span>,which is equal to the theoretical lambda <span class="math inline">\(0.9642857\)</span>.</p>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Why are the following two invocations of lapply() equivalent?</p>
<p><span class="math inline">\(trims &lt;- c(0, 0.1, 0.2, 0.5)\\x &lt;- rcauchy(100)\\lapply(trims, function(trim) mean(x, trim = trim))\\lapply(trims, mean, x = x)\)</span></p>
</div>
<div id="anwser-8" class="section level2">
<h2>Anwser</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim)))</span></code></pre></div>
<pre><code>## [1] -1.1661587 -0.4849343 -0.2858702 -0.1701439</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x))</span></code></pre></div>
<pre><code>## [1] -1.1661587 -0.4849343 -0.2858702 -0.1701439</code></pre>
<p>From the result of code,they are the same.</p>
<p>This is because the pieces of x are always supplied as the first argument to f and trims are supplied as the second argument “trim” to f.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div id="anwser-9" class="section level2">
<h2>Anwser</h2>
<p>In exercise 3,we have:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co">#method 1 for excercise 3</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>l3<span class="ot">=</span><span class="fu">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="fu">lm</span>(<span class="at">formula =</span> x, <span class="at">data =</span> mtcars))</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>rsq3<span class="fl">.1</span><span class="ot">=</span><span class="fu">lapply</span>(l3,rsq)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(rsq3<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#method 2 for excercise 3</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>rsq3<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">lapply</span>(formulas, <span class="cf">function</span>(x){</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  mod<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">formula =</span> x, <span class="at">data =</span> mtcars)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rsq</span>(mod)}</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(rsq3<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">#method 1 for excercise 4</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>l4<span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(x) <span class="fu">lm</span>(<span class="at">formula =</span>mpg <span class="sc">~</span> disp, <span class="at">data =</span> x))</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>rsq4<span class="fl">.1</span><span class="ot">=</span><span class="fu">lapply</span>(l4,rsq)<span class="co">#method 1 for excercise 4</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(rsq4<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  [1] 0.7841864 0.5543517 0.7707085 0.6712950 0.7118090 0.6483252 0.7149986
##  [8] 0.6245985 0.7192072 0.6804647</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#method 2 for excercise 4</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>rsq4<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(x){</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  l<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">formula =</span>mpg <span class="sc">~</span> disp, <span class="at">data =</span> x)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rsq</span>(l)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(rsq4<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  [1] 0.7841864 0.5543517 0.7707085 0.6712950 0.7118090 0.6483252 0.7149986
##  [8] 0.6245985 0.7192072 0.6804647</code></pre>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Use vapply() to: a) Compute the standard deviation of every column in a numeric data frame. b) Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</p>
</div>
<div id="anwser-10" class="section level2">
<h2>Anwser</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(a)Compute sd of every column in a numeric data frame</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(mtcars,class))</span></code></pre></div>
<pre><code>##       mpg       cyl      disp        hp      drat        wt      qsec        vs 
## &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; 
##        am      gear      carb 
## &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mtcars is a numeric data frame,so we take it as example.</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mtcars,sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(b)Compute sd of every numeric column in a mixed data frame</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(CO2)<span class="co">#Carbon Dioxide Uptake in Grass Plants;CO2 is a mixed data frame</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>idx<span class="ot">&lt;-</span><span class="fu">vapply</span>(CO2,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(CO2[idx],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##      conc    uptake 
## 295.92412  10.81441</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
<div id="anwser-11" class="section level2">
<h2>Anwser</h2>
<p><strong>Consider replce lapply() in mclapply() with sapply() in R</strong></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>sapply <span class="ot">&lt;-</span> <span class="cf">function</span> (X, FUN, ..., <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    FUN <span class="ot">&lt;-</span> <span class="fu">match.fun</span>(FUN)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    answer <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> X, <span class="at">FUN =</span> FUN, ...)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (USE.NAMES <span class="sc">&amp;&amp;</span> <span class="fu">is.character</span>(X) <span class="sc">&amp;&amp;</span> <span class="fu">is.null</span>(<span class="fu">names</span>(answer))) </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(answer) <span class="ot">&lt;-</span> X</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">isFALSE</span>(simplify) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(answer)) </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">simplify2array</span>(answer, <span class="at">higher =</span> (simplify <span class="sc">==</span> <span class="st">&quot;array&quot;</span>))</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> answer</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span> (X, FUN, ..., <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  FUN <span class="ot">&lt;-</span> <span class="fu">match.fun</span>(FUN)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  answer <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(<span class="at">X =</span> X, <span class="at">FUN =</span> FUN, ...)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (USE.NAMES <span class="sc">&amp;&amp;</span> <span class="fu">is.character</span>(X) <span class="sc">&amp;&amp;</span> <span class="fu">is.null</span>(<span class="fu">names</span>(answer))) </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(answer) <span class="ot">&lt;-</span> X</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">isFALSE</span>(simplify) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(answer)) </span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">simplify2array</span>(answer, <span class="at">higher =</span> (simplify <span class="sc">==</span> <span class="st">&quot;array&quot;</span>))</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> answer</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>boot_df <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x[<span class="fu">sample</span>(<span class="fu">nrow</span>(x), <span class="at">rep =</span> T), ]</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>rsquared <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.square</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>boot_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">boot_df</span>(mtcars)</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rsquared</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> disp, <span class="at">data =</span> dat))</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, boot_lm))</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">mcsapply</span>(<span class="dv">1</span><span class="sc">:</span>n, boot_lm,<span class="at">mc.cores=</span><span class="dv">1</span>))</span></code></pre></div>
<p>I cannot implement mcvapply(), a parallel version of vapply() because the FUN.VALUE can’t be an environment value.</p>
</div>
<div id="homwork-11" class="section level2">
<h2>Homwork 11</h2>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 9.8:</p>
<p>Consider the bivariate density <span class="math display">\[f(x, y) \varpropto {n\choose x}y^{x+a−1}(1 − y)^
{n−x+b−1}, x = 0, 1, . . . , n, 0 ≤ y ≤ 1.\]</span> It can be shown that for fixed a, b, n, the conditional distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the Gibbs sampler to generate a chain with target joint density f(x, y).</p>
<ol style="list-style-type: decimal">
<li><p>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p></li>
<li><p>Campare the computation time of the two functions with the function “microbenchmark”.</p></li>
<li><p>Comments your results.</p></li>
</ol>
<p>Produce the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
<p><strong>Pure R function:</strong></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>gibbsR<span class="ot">&lt;-</span> <span class="cf">function</span>(N,<span class="at">n=</span><span class="dv">9</span>,<span class="at">a=</span><span class="dv">2</span>,<span class="at">b=</span><span class="dv">3</span>) {</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span><span class="dv">5</span>; y <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob=</span>y)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>      mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  mat</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Rcpp function :</strong></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix gibbs_C(int N){</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="st">  int x0=5;</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="st">  double y0=0.5;</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="st">  int n=9;</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="st">  int a=2;</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="st">  int b=3;</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="st">  for (int i=0; i&lt;N;i++) {</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="st">    int x = rbinom(1, n, y0)[0];</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i,0)=x;</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="st">    x0=x;</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="st">    double y = rbeta(1, x0+a, n-x0+b)[0];</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="st">    mat(i,1)=y;</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="st">    y0=y;</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="st">  return(mat);</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<p>Generate two random numbers with Rcpp function and pure R language.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">gibbsR</span>(<span class="dv">5000</span>)<span class="do">##random numbers with R</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">gibbs_C</span>(<span class="dv">5000</span>)<span class="do">##random numbers with Rcpp</span></span></code></pre></div>
<p><strong>compare two marginal distributions</strong>:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>xR<span class="ot">&lt;-</span>x1[,<span class="dv">1</span>]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>xC<span class="ot">&lt;-</span>x2[,<span class="dv">1</span>]</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>yR<span class="ot">&lt;-</span>x1[,<span class="dv">2</span>]</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>yC<span class="ot">&lt;-</span>x2[,<span class="dv">2</span>]</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(xR[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)],xC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)])</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(yR[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)],yC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)])</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot, it appears that two marginal distributions of one random numbers are in approximate agreement with the other.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">gibR=</span><span class="fu">gibbsR</span>(<span class="dv">5000</span>),<span class="at">gibC=</span><span class="fu">gibbs_C</span>(<span class="dv">5000</span>))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr       lq  median       uq
## 1 gibR 23.95980 29.6722 31.12140
## 2 gibC  1.62745  1.6919  1.78175</code></pre>
<p>We get much faster using Rcpp than pure R language.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
